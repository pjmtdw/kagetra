- content_for :title do
  Wiki
- content_for :js_start do
  wiki
- content_for :css do
  wiki
= haml :top_bar

#wiki-item

#wiki-edit

#wiki-attached

%script#templ-wiki-item(type='text/template')
  .row
    .large-9.columns
      .viewlog
        .left.wiki-title {- data.title -}
        <% _.each(viewlog,function(x){ if(x[0]!=data.id){ %>
        %a.left(href='wiki#page/{{x[0]}}') {- x[1] -}
        <% }}) %>
    .large-3.columns
      %button#edit-new.small.round 新規作成
      %button#edit-start.small.round 編集
      %button#edit-start.small.round ログ
  .row
    .large-12.columns
      {{ data.html }}

%script#templ-wiki-preview(type='text/template')
  .row
    .large-12.columns
      <%= data.html %>

%script#templ-wiki-edit(type='text/template')
  .row
    .large-12.columns
      %button#edit-cancel.small.round キャンセル
      %button#edit-preview.small.round プレビュー
      %button#edit-done.small.round 更新
  %form#wiki-edit-form
    .row
      .large-12.columns
        %input(type='text' name='title' placeholder='タイトル' value='{-data.title-}')
    .row
      .large-12.columns
        %textarea(name='body' rows=60 placeholder='本文') {{data.body}}


%script#templ-wiki-attached(type='text/template')
  .row
    .large-12.columns
      %button#toggle-attached.small.round ファイル添付
      %form#attached-form.hide(action='wiki/attached/{{data.item_id}}' method='post' enctype='multipart/form-data')
        %fieldset
          %legend ファイル添付
          %label ファイル
          %input(type='file' name='file')
          %label 説明
          %input(type='text' name='description')
          %input(type='submit' value='送信')

  .row
    .large-12.columns
      %ul.pagination
        <% for(i=0;i<data.pages;i++){ %>
        %li(class='{{i+1==data.cur_page?"current":""}}')
          %a.page(data-page='{{i+1}}') {{i+1}}
        <% } %>
      %table
        <% _.each(data.list,function(x){ %>
        %tr
          %td.filename
            %a(href='static/wiki/attached/{{x.id}}') {- x.orig_name -}
          %td.size
            {{_.show_size(x.size)}}
          %td.date
            {{x.date}}
          %td {{x.description}}
        <% }) %>

#container-wiki-preview.reveal-modal
